<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>webOS</title>

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        background: white;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      canvas {
        display: block;
        margin: auto;
        padding: 10px;
        background: black;
      }
    </style>
  </head>
  <body>
    <canvas id="screen" width="800" height="400"></canvas>

    <script src="./hal/hal.js"></script>
    <script>
      async function boot() {
        const response = await fetch("../build/shell.wasm");
        const bytes = await response.arrayBuffer();

        const imports = {
          env: {
            __hal_write_char,
            __hal_read_char,
          },
        };

        const { instance } = await WebAssembly.instantiate(bytes, imports);

        // Call user-space main()
        if (instance.exports.main) {
          instance.exports.main();
        } else {
          console.error("main() not found in WASM");
        }
      }

      boot();
    </script>
  </body>
</html>
